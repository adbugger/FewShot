Namespace(T_max=100, backbone='resnet50', base_learning_rate=0.1, base_optimizer='SGD', batch_size=256, dampening=0.0, dataset='cifar100fs', dataset_root=None, distributed=False, episode_strat='SimpleShotEpisodes', eval_freq=5, first_augment='CropResize', head='SimpleMLP', jitter_strength=1.0, k_shot=5, load_from=None, local_rank=0, log_file=<_io.TextIOWrapper name='cifar100fs_round3/CropResize_ColorDistort_runs/run3.out' mode='a' encoding='UTF-8'>, loss_function='NTXent', model='SimCLRModel', momentum=0.9, n_way=5, nesterov=True, ntxent_temp=1.0, num_epochs=100, num_query=15, num_test_tasks=10000, num_workers=4, pin_memory=True, pretrained=False, progress=False, projection_dim=128, save_model=True, save_path='cifar100fs_round3/CropResize_ColorDistort_runs/run3.pth', scheduler='CosineAnnealingLR', second_augment='ColorDistort', secondary_optimizer='LARS', shuffle=True, simple_opt=False, weight_decay=0.0001)
Starting Training on:
Train:  64 classes
Valid:  16 classes
Test:   20 classes
------------------
( 35.306s) Epoch 001/100: loss=[32m5.946864[0m
( 35.559s) Epoch 002/100: loss=[32m5.804615[0m
( 35.620s) Epoch 003/100: loss=[32m5.772989[0m
( 35.015s) Epoch 004/100: loss=[32m5.753591[0m
( 35.056s) Epoch 005/100: loss=[32m5.743207[0m  ( 28.917s)  train_acc=[32m0.014890[0m val_acc=[32m0.035521[0m test_acc=[32m0.035050[0m
( 35.703s) Epoch 006/100: loss=[32m5.730606[0m
( 35.633s) Epoch 007/100: loss=[32m5.720180[0m
( 35.573s) Epoch 008/100: loss=[32m5.709866[0m
( 34.957s) Epoch 009/100: loss=[32m5.703298[0m
( 35.154s) Epoch 010/100: loss=[32m5.696786[0m  ( 28.718s)  train_acc=[32m0.017793[0m val_acc=[32m0.043975[0m test_acc=[32m0.037828[0m
( 35.824s) Epoch 011/100: loss=[32m5.691512[0m
( 35.274s) Epoch 012/100: loss=[32m5.680173[0m
( 34.943s) Epoch 013/100: loss=[32m5.674627[0m
( 34.676s) Epoch 014/100: loss=[32m5.670087[0m
( 35.096s) Epoch 015/100: loss=[32m5.664668[0m  ( 31.367s)  train_acc=0.016559[0m val_acc=0.039644[0m test_acc=[32m0.038488[0m
( 34.963s) Epoch 016/100: loss=[32m5.661960[0m
( 35.114s) Epoch 017/100: loss=[32m5.656997[0m
( 34.452s) Epoch 018/100: loss=[32m5.655748[0m
( 34.910s) Epoch 019/100: loss=[32m5.651052[0m
( 35.172s) Epoch 020/100: loss=[32m5.649448[0m  ( 30.754s)  train_acc=0.016752[0m val_acc=[32m0.044656[0m test_acc=0.038380[0m
( 35.759s) Epoch 021/100: loss=[32m5.645497[0m
( 35.392s) Epoch 022/100: loss=5.645564[0m
( 34.861s) Epoch 023/100: loss=[32m5.642300[0m
( 34.810s) Epoch 024/100: loss=[32m5.638103[0m
( 35.228s) Epoch 025/100: loss=[32m5.637546[0m  ( 30.314s)  train_acc=[32m0.017876[0m val_acc=0.041808[0m test_acc=[32m0.046583[0m
( 33.986s) Epoch 026/100: loss=5.638032[0m
( 35.327s) Epoch 027/100: loss=[32m5.633107[0m
( 35.063s) Epoch 028/100: loss=[32m5.628615[0m
( 34.880s) Epoch 029/100: loss=[32m5.627219[0m
( 35.256s) Epoch 030/100: loss=5.628476[0m  ( 30.504s)  train_acc=0.017714[0m val_acc=0.034475[0m test_acc=0.045739[0m
( 32.921s) Epoch 031/100: loss=[32m5.623834[0m
( 35.651s) Epoch 032/100: loss=5.629690[0m
( 35.602s) Epoch 033/100: loss=[32m5.623735[0m
( 35.164s) Epoch 034/100: loss=[32m5.617525[0m
( 34.848s) Epoch 035/100: loss=5.617804[0m  ( 33.377s)  train_acc=0.017507[0m val_acc=0.043950[0m test_acc=[32m0.047397[0m
( 32.528s) Epoch 036/100: loss=[32m5.614445[0m
( 35.771s) Epoch 037/100: loss=5.614498[0m
( 35.606s) Epoch 038/100: loss=[32m5.612891[0m
( 35.024s) Epoch 039/100: loss=5.612927[0m
( 35.718s) Epoch 040/100: loss=[32m5.607938[0m  ( 26.619s)  train_acc=0.017021[0m val_acc=[32m0.045957[0m test_acc=[32m0.048194[0m
( 33.702s) Epoch 041/100: loss=[32m5.606447[0m
( 34.532s) Epoch 042/100: loss=[32m5.606438[0m
( 35.120s) Epoch 043/100: loss=[32m5.602201[0m
( 35.182s) Epoch 044/100: loss=5.603655[0m
( 35.314s) Epoch 045/100: loss=[32m5.599270[0m  ( 29.254s)  train_acc=0.017194[0m val_acc=[32m0.046102[0m test_acc=0.042929[0m
( 33.733s) Epoch 046/100: loss=[32m5.597677[0m
( 34.191s) Epoch 047/100: loss=5.600170[0m
( 35.614s) Epoch 048/100: loss=5.597990[0m
( 35.335s) Epoch 049/100: loss=[32m5.596208[0m
( 35.528s) Epoch 050/100: loss=[32m5.593331[0m  ( 28.954s)  train_acc=0.017591[0m val_acc=0.042781[0m test_acc=0.046555[0m
( 34.994s) Epoch 051/100: loss=[32m5.590238[0m
( 33.603s) Epoch 052/100: loss=5.590269[0m
( 35.470s) Epoch 053/100: loss=5.590859[0m
( 35.474s) Epoch 054/100: loss=[32m5.588279[0m
( 35.490s) Epoch 055/100: loss=[32m5.586816[0m  ( 31.615s)  train_acc=[32m0.018142[0m val_acc=0.044801[0m test_acc=0.044909[0m
( 35.367s) Epoch 056/100: loss=5.587139[0m
( 33.862s) Epoch 057/100: loss=[32m5.585209[0m
( 35.318s) Epoch 058/100: loss=[32m5.583698[0m
( 35.314s) Epoch 059/100: loss=5.589703[0m
( 35.330s) Epoch 060/100: loss=5.584283[0m  ( 30.552s)  train_acc=0.017382[0m val_acc=0.041402[0m test_acc=0.042222[0m
( 35.569s) Epoch 061/100: loss=[32m5.580608[0m
( 33.524s) Epoch 062/100: loss=5.582185[0m
( 35.282s) Epoch 063/100: loss=[32m5.579230[0m
( 35.260s) Epoch 064/100: loss=[32m5.577937[0m
( 35.213s) Epoch 065/100: loss=5.579192[0m  ( 30.174s)  train_acc=0.017594[0m val_acc=0.040283[0m test_acc=[32m0.051500[0m
( 35.184s) Epoch 066/100: loss=[32m5.573105[0m
( 33.177s) Epoch 067/100: loss=5.574204[0m
( 33.903s) Epoch 068/100: loss=5.574911[0m
( 35.536s) Epoch 069/100: loss=5.573199[0m
( 35.191s) Epoch 070/100: loss=[32m5.569078[0m  ( 31.892s)  train_acc=[32m0.018315[0m val_acc=0.042874[0m test_acc=0.042046[0m
( 35.464s) Epoch 071/100: loss=5.570724[0m
( 34.805s) Epoch 072/100: loss=5.571143[0m
( 34.977s) Epoch 073/100: loss=5.569772[0m
( 35.436s) Epoch 074/100: loss=5.571392[0m
( 35.394s) Epoch 075/100: loss=5.570338[0m  ( 29.333s)  train_acc=0.018268[0m val_acc=0.038013[0m test_acc=0.044503[0m
( 35.698s) Epoch 076/100: loss=[32m5.567773[0m
( 35.521s) Epoch 077/100: loss=[32m5.566647[0m
( 33.861s) Epoch 078/100: loss=[32m5.564966[0m
( 35.659s) Epoch 079/100: loss=5.565828[0m
( 34.797s) Epoch 080/100: loss=5.567353[0m  ( 23.909s)  train_acc=0.018092[0m val_acc=[32m0.049615[0m test_acc=0.050052[0m
( 34.780s) Epoch 081/100: loss=[32m5.563860[0m
( 35.464s) Epoch 082/100: loss=[32m5.563556[0m
( 34.645s) Epoch 083/100: loss=[32m5.561215[0m
( 33.977s) Epoch 084/100: loss=[32m5.561136[0m
( 35.511s) Epoch 085/100: loss=5.561214[0m  ( 27.101s)  train_acc=0.017423[0m val_acc=[32m0.054377[0m test_acc=0.043557[0m
( 34.235s) Epoch 086/100: loss=[32m5.559484[0m
( 35.625s) Epoch 087/100: loss=[32m5.558205[0m
( 34.965s) Epoch 088/100: loss=5.558958[0m
( 33.461s) Epoch 089/100: loss=5.559402[0m
( 35.606s) Epoch 090/100: loss=5.558755[0m  ( 23.500s)  train_acc=0.017723[0m val_acc=0.039503[0m test_acc=0.050507[0m
( 33.127s) Epoch 091/100: loss=[32m5.557729[0m
( 35.462s) Epoch 092/100: loss=5.558030[0m
( 35.323s) Epoch 093/100: loss=5.558036[0m
( 34.215s) Epoch 094/100: loss=5.560873[0m
( 33.274s) Epoch 095/100: loss=[32m5.555409[0m  ( 29.360s)  train_acc=0.018273[0m val_acc=0.049541[0m test_acc=0.048523[0m
( 33.761s) Epoch 096/100: loss=5.556536[0m
( 35.348s) Epoch 097/100: loss=5.556697[0m
( 35.025s) Epoch 098/100: loss=[32m5.555338[0m
( 34.979s) Epoch 099/100: loss=[32m5.554824[0m
( 35.403s) Epoch 100/100: loss=5.557158[0m  ( 27.328s)  train_acc=0.018235[0m val_acc=0.041950[0m test_acc=0.044440[0m
Training for 100 epochs took 3495.500s total and 34.955s average
Calculating mean of transformed dataset using the best model state ... 12.635s
Saving best model and options to cifar100fs_round3/CropResize_ColorDistort_runs/run3.pth
