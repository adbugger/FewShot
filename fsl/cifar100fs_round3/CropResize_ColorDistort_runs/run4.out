Namespace(T_max=100, backbone='resnet50', base_learning_rate=0.1, base_optimizer='SGD', batch_size=256, dampening=0.0, dataset='cifar100fs', dataset_root=None, distributed=False, episode_strat='SimpleShotEpisodes', eval_freq=5, first_augment='CropResize', head='SimpleMLP', jitter_strength=1.0, k_shot=5, load_from=None, local_rank=0, log_file=<_io.TextIOWrapper name='cifar100fs_round3/CropResize_ColorDistort_runs/run4.out' mode='a' encoding='UTF-8'>, loss_function='NTXent', model='SimCLRModel', momentum=0.9, n_way=5, nesterov=True, ntxent_temp=1.0, num_epochs=100, num_query=15, num_test_tasks=10000, num_workers=4, pin_memory=True, pretrained=False, progress=False, projection_dim=128, save_model=True, save_path='cifar100fs_round3/CropResize_ColorDistort_runs/run4.pth', scheduler='CosineAnnealingLR', second_augment='ColorDistort', secondary_optimizer='LARS', shuffle=True, simple_opt=False, weight_decay=0.0001)
Starting Training on:
Train:  64 classes
Valid:  16 classes
Test:   20 classes
------------------
( 35.324s) Epoch 001/100: loss=[32m5.974268[0m
( 35.964s) Epoch 002/100: loss=[32m5.872111[0m
( 36.297s) Epoch 003/100: loss=[32m5.807832[0m
( 36.387s) Epoch 004/100: loss=[32m5.767212[0m
( 36.285s) Epoch 005/100: loss=[32m5.747240[0m  ( 25.519s)  train_acc=[32m0.016596[0m val_acc=[32m0.027153[0m test_acc=[32m0.032577[0m
( 35.899s) Epoch 006/100: loss=[32m5.735545[0m
( 36.156s) Epoch 007/100: loss=[32m5.723627[0m
( 36.437s) Epoch 008/100: loss=[32m5.716300[0m
( 36.243s) Epoch 009/100: loss=[32m5.708758[0m
( 36.549s) Epoch 010/100: loss=[32m5.696496[0m  ( 27.373s)  train_acc=[32m0.018290[0m val_acc=[32m0.040804[0m test_acc=[32m0.035753[0m
( 35.795s) Epoch 011/100: loss=[32m5.690828[0m
( 36.244s) Epoch 012/100: loss=[32m5.683919[0m
( 36.413s) Epoch 013/100: loss=[32m5.680716[0m
( 36.471s) Epoch 014/100: loss=[32m5.672990[0m
( 36.352s) Epoch 015/100: loss=[32m5.667251[0m  ( 30.716s)  train_acc=[32m0.019810[0m val_acc=0.036905[0m test_acc=[32m0.036070[0m
( 35.543s) Epoch 016/100: loss=[32m5.667044[0m
( 36.216s) Epoch 017/100: loss=[32m5.661134[0m
( 36.230s) Epoch 018/100: loss=[32m5.658743[0m
( 36.308s) Epoch 019/100: loss=[32m5.653021[0m
( 35.992s) Epoch 020/100: loss=[32m5.652194[0m  ( 33.384s)  train_acc=0.017920[0m val_acc=0.037645[0m test_acc=[32m0.037653[0m
( 34.923s) Epoch 021/100: loss=[32m5.646968[0m
( 35.950s) Epoch 022/100: loss=[32m5.644136[0m
( 36.119s) Epoch 023/100: loss=[32m5.641517[0m
( 35.974s) Epoch 024/100: loss=[32m5.639007[0m
( 35.738s) Epoch 025/100: loss=[32m5.638344[0m  ( 31.841s)  train_acc=0.018178[0m val_acc=[32m0.042674[0m test_acc=[32m0.039598[0m
( 35.075s) Epoch 026/100: loss=[32m5.632911[0m
( 35.939s) Epoch 027/100: loss=[32m5.631917[0m
( 36.022s) Epoch 028/100: loss=[32m5.628648[0m
( 35.915s) Epoch 029/100: loss=[32m5.623313[0m
( 35.565s) Epoch 030/100: loss=[32m5.622338[0m  ( 32.667s)  train_acc=0.017693[0m val_acc=0.039416[0m test_acc=[32m0.043034[0m
( 35.122s) Epoch 031/100: loss=[32m5.620961[0m
( 35.565s) Epoch 032/100: loss=[32m5.618343[0m
( 35.736s) Epoch 033/100: loss=5.620433[0m
( 35.778s) Epoch 034/100: loss=[32m5.616640[0m
( 35.645s) Epoch 035/100: loss=[32m5.616390[0m  ( 34.345s)  train_acc=0.017912[0m val_acc=0.036361[0m test_acc=0.040671[0m
( 34.714s) Epoch 036/100: loss=[32m5.609358[0m
( 35.494s) Epoch 037/100: loss=5.609702[0m
( 35.562s) Epoch 038/100: loss=[32m5.607151[0m
( 35.420s) Epoch 039/100: loss=[32m5.604351[0m
( 35.141s) Epoch 040/100: loss=5.607175[0m  ( 34.143s)  train_acc=0.018167[0m val_acc=[32m0.049530[0m test_acc=0.042155[0m
( 35.762s) Epoch 041/100: loss=5.607771[0m
( 36.319s) Epoch 042/100: loss=5.604831[0m
( 36.521s) Epoch 043/100: loss=[32m5.601242[0m
( 36.102s) Epoch 044/100: loss=[32m5.598896[0m
( 35.748s) Epoch 045/100: loss=5.598897[0m  ( 32.474s)  train_acc=0.017877[0m val_acc=0.038001[0m test_acc=0.039927[0m
( 35.215s) Epoch 046/100: loss=[32m5.594660[0m
( 36.016s) Epoch 047/100: loss=[32m5.593291[0m
( 36.211s) Epoch 048/100: loss=[32m5.591539[0m
( 35.702s) Epoch 049/100: loss=5.593737[0m
( 35.731s) Epoch 050/100: loss=[32m5.590615[0m  ( 31.800s)  train_acc=0.018088[0m val_acc=0.040475[0m test_acc=[32m0.043630[0m
( 35.418s) Epoch 051/100: loss=[32m5.590595[0m
( 35.942s) Epoch 052/100: loss=[32m5.588867[0m
( 36.000s) Epoch 053/100: loss=[32m5.585870[0m
( 35.956s) Epoch 054/100: loss=5.595264[0m
( 35.412s) Epoch 055/100: loss=5.586051[0m  ( 34.089s)  train_acc=0.018207[0m val_acc=[32m0.050390[0m test_acc=[32m0.044397[0m
( 35.152s) Epoch 056/100: loss=5.586613[0m
( 35.539s) Epoch 057/100: loss=[32m5.583816[0m
( 35.887s) Epoch 058/100: loss=[32m5.580565[0m
( 36.482s) Epoch 059/100: loss=5.582123[0m
( 36.109s) Epoch 060/100: loss=[32m5.577814[0m  ( 33.933s)  train_acc=0.019196[0m val_acc=0.044686[0m test_acc=[32m0.045181[0m
( 36.190s) Epoch 061/100: loss=5.579555[0m
( 36.384s) Epoch 062/100: loss=5.579407[0m
( 36.362s) Epoch 063/100: loss=[32m5.574536[0m
( 35.187s) Epoch 064/100: loss=5.575659[0m
( 36.029s) Epoch 065/100: loss=[32m5.572850[0m  ( 38.891s)  train_acc=0.018390[0m val_acc=[32m0.052125[0m test_acc=[32m0.050482[0m
( 35.648s) Epoch 066/100: loss=5.575193[0m
( 35.943s) Epoch 067/100: loss=[32m5.570240[0m
( 36.196s) Epoch 068/100: loss=5.571048[0m
( 35.655s) Epoch 069/100: loss=5.570690[0m
( 35.629s) Epoch 070/100: loss=[32m5.570207[0m  ( 33.036s)  train_acc=0.018151[0m val_acc=0.049320[0m test_acc=0.049449[0m
( 35.158s) Epoch 071/100: loss=[32m5.567394[0m
( 35.773s) Epoch 072/100: loss=5.567672[0m
( 35.674s) Epoch 073/100: loss=[32m5.565905[0m
( 35.433s) Epoch 074/100: loss=5.568485[0m
( 35.496s) Epoch 075/100: loss=5.566271[0m  ( 41.024s)  train_acc=0.018086[0m val_acc=[32m0.054605[0m test_acc=0.046093[0m
( 35.916s) Epoch 076/100: loss=[32m5.565438[0m
( 36.269s) Epoch 077/100: loss=[32m5.565356[0m
( 35.701s) Epoch 078/100: loss=[32m5.562970[0m
( 35.865s) Epoch 079/100: loss=[32m5.562411[0m
( 36.027s) Epoch 080/100: loss=[32m5.559131[0m  ( 34.057s)  train_acc=0.018119[0m val_acc=0.041957[0m test_acc=[32m0.050520[0m
( 35.843s) Epoch 081/100: loss=[32m5.558525[0m
( 36.238s) Epoch 082/100: loss=5.561875[0m
( 35.779s) Epoch 083/100: loss=5.561780[0m
( 35.495s) Epoch 084/100: loss=5.559430[0m
( 35.532s) Epoch 085/100: loss=[32m5.556714[0m  ( 40.359s)  train_acc=0.018448[0m val_acc=0.039253[0m test_acc=0.044526[0m
( 34.688s) Epoch 086/100: loss=5.560144[0m
( 35.120s) Epoch 087/100: loss=5.558057[0m
( 36.181s) Epoch 088/100: loss=[32m5.556085[0m
( 35.858s) Epoch 089/100: loss=5.556242[0m
( 36.065s) Epoch 090/100: loss=5.556168[0m  ( 38.439s)  train_acc=0.018210[0m val_acc=0.041710[0m test_acc=0.050379[0m
( 35.603s) Epoch 091/100: loss=[32m5.555554[0m
( 36.026s) Epoch 092/100: loss=5.556124[0m
( 35.415s) Epoch 093/100: loss=[32m5.555439[0m
( 35.737s) Epoch 094/100: loss=[32m5.554102[0m
( 35.593s) Epoch 095/100: loss=5.554545[0m  ( 41.161s)  train_acc=0.018347[0m val_acc=0.054545[0m test_acc=0.046524[0m
( 33.601s) Epoch 096/100: loss=5.555911[0m
( 33.034s) Epoch 097/100: loss=[32m5.553234[0m
( 31.341s) Epoch 098/100: loss=[32m5.552199[0m
( 31.331s) Epoch 099/100: loss=5.553729[0m
( 31.472s) Epoch 100/100: loss=5.553361[0m  ( 15.548s)  train_acc=0.018101[0m val_acc=0.053582[0m test_acc=0.046618[0m
Training for 100 epochs took 3564.210s total and 35.642s average
Calculating mean of transformed dataset using the best model state ... 4.361s
Saving best model and options to cifar100fs_round3/CropResize_ColorDistort_runs/run4.pth
