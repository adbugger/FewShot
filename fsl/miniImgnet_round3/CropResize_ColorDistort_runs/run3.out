Namespace(T_max=100, backbone='resnet50', base_learning_rate=0.1, base_optimizer='SGD', batch_size=256, dampening=0.0, dataset='miniImagenet', dataset_root=None, distributed=False, episode_strat='SimpleShotEpisodes', eval_freq=5, first_augment='CropResize', head='SimpleMLP', jitter_strength=1.0, k_shot=5, load_from=None, local_rank=0, log_file=<_io.TextIOWrapper name='miniImgnet_round3/CropResize_ColorDistort_runs/run3.out' mode='a' encoding='UTF-8'>, loss_function='NTXent', model='SimCLRModel', momentum=0.9, n_way=5, nesterov=True, ntxent_temp=1.0, num_epochs=100, num_query=15, num_test_tasks=10000, num_workers=4, pin_memory=True, pretrained=False, progress=False, projection_dim=128, save_model=True, save_path='miniImgnet_round3/CropResize_ColorDistort_runs/run3.pth', scheduler='CosineAnnealingLR', second_augment='ColorDistort', secondary_optimizer='LARS', shuffle=True, simple_opt=False, weight_decay=0.0001)
Starting Training on:
Train:  64 classes
Valid:  16 classes
Test:   20 classes
------------------
( 89.247s) Epoch 001/100: loss=[32m6.179713[0m
( 89.551s) Epoch 002/100: loss=[32m6.040197[0m
( 90.300s) Epoch 003/100: loss=[32m5.936251[0m
( 89.656s) Epoch 004/100: loss=[32m5.867163[0m
( 89.408s) Epoch 005/100: loss=[32m5.817341[0m  ( 39.002s)  train_acc=[32m0.011102[0m val_acc=[32m0.024416[0m test_acc=[32m0.016267[0m
( 89.108s) Epoch 006/100: loss=[32m5.780709[0m
( 89.277s) Epoch 007/100: loss=[32m5.754715[0m
( 95.059s) Epoch 008/100: loss=[32m5.733323[0m
( 89.300s) Epoch 009/100: loss=[32m5.719561[0m
( 89.324s) Epoch 010/100: loss=[32m5.705710[0m  ( 42.828s)  train_acc=[32m0.012562[0m val_acc=[32m0.029545[0m test_acc=[32m0.019873[0m
( 89.169s) Epoch 011/100: loss=[32m5.692881[0m
( 89.264s) Epoch 012/100: loss=[32m5.683587[0m
( 90.154s) Epoch 013/100: loss=[32m5.672257[0m
( 89.077s) Epoch 014/100: loss=[32m5.665809[0m
( 89.351s) Epoch 015/100: loss=[32m5.657920[0m  ( 40.801s)  train_acc=0.011977[0m val_acc=[32m0.029659[0m test_acc=[32m0.021546[0m
( 88.953s) Epoch 016/100: loss=[32m5.648104[0m
( 89.406s) Epoch 017/100: loss=[32m5.642592[0m
( 89.322s) Epoch 018/100: loss=[32m5.638524[0m
( 89.058s) Epoch 019/100: loss=[32m5.630213[0m
( 89.214s) Epoch 020/100: loss=[32m5.625197[0m  ( 39.907s)  train_acc=[32m0.013800[0m val_acc=0.028424[0m test_acc=[32m0.024011[0m
( 89.136s) Epoch 021/100: loss=[32m5.616196[0m
( 89.126s) Epoch 022/100: loss=[32m5.612572[0m
( 89.087s) Epoch 023/100: loss=[32m5.607595[0m
( 89.117s) Epoch 024/100: loss=[32m5.602988[0m
( 88.988s) Epoch 025/100: loss=[32m5.598387[0m  ( 41.069s)  train_acc=[32m0.014824[0m val_acc=[32m0.031695[0m test_acc=[32m0.024634[0m
( 89.041s) Epoch 026/100: loss=[32m5.594314[0m
( 89.273s) Epoch 027/100: loss=[32m5.589911[0m
( 89.381s) Epoch 028/100: loss=[32m5.584877[0m
( 93.031s) Epoch 029/100: loss=[32m5.582246[0m
( 89.292s) Epoch 030/100: loss=[32m5.578103[0m  ( 40.434s)  train_acc=[32m0.014910[0m val_acc=[32m0.034390[0m test_acc=[32m0.026275[0m
( 89.255s) Epoch 031/100: loss=5.578436[0m
( 89.663s) Epoch 032/100: loss=[32m5.571663[0m
( 89.340s) Epoch 033/100: loss=[32m5.570831[0m
( 89.073s) Epoch 034/100: loss=[32m5.565507[0m
( 91.900s) Epoch 035/100: loss=5.568269[0m  ( 42.395s)  train_acc=0.014637[0m val_acc=[32m0.036241[0m test_acc=[32m0.029575[0m
( 89.399s) Epoch 036/100: loss=[32m5.563406[0m
( 89.163s) Epoch 037/100: loss=[32m5.560661[0m
( 89.138s) Epoch 038/100: loss=[32m5.558429[0m
( 88.960s) Epoch 039/100: loss=[32m5.554497[0m
( 89.023s) Epoch 040/100: loss=[32m5.551168[0m  ( 43.910s)  train_acc=[32m0.015700[0m val_acc=[32m0.036938[0m test_acc=0.028835[0m
( 88.973s) Epoch 041/100: loss=[32m5.548150[0m
( 89.382s) Epoch 042/100: loss=[32m5.546604[0m
( 89.129s) Epoch 043/100: loss=5.547584[0m
( 89.085s) Epoch 044/100: loss=[32m5.545814[0m
( 88.994s) Epoch 045/100: loss=[32m5.541211[0m  ( 41.216s)  train_acc=[32m0.016031[0m val_acc=[32m0.039069[0m test_acc=[32m0.031762[0m
( 89.040s) Epoch 046/100: loss=[32m5.538365[0m
( 89.474s) Epoch 047/100: loss=5.538583[0m
( 89.234s) Epoch 048/100: loss=[32m5.538092[0m
( 89.279s) Epoch 049/100: loss=[32m5.536251[0m
( 89.299s) Epoch 050/100: loss=[32m5.534647[0m  ( 43.817s)  train_acc=[32m0.016830[0m val_acc=[32m0.040083[0m test_acc=0.031419[0m
( 89.331s) Epoch 051/100: loss=[32m5.531768[0m
( 89.735s) Epoch 052/100: loss=[32m5.529963[0m
( 89.448s) Epoch 053/100: loss=5.530968[0m
( 89.294s) Epoch 054/100: loss=[32m5.528156[0m
( 89.120s) Epoch 055/100: loss=[32m5.528030[0m  ( 40.816s)  train_acc=0.016711[0m val_acc=0.037314[0m test_acc=[32m0.033948[0m
( 89.144s) Epoch 056/100: loss=[32m5.526229[0m
( 89.558s) Epoch 057/100: loss=[32m5.522894[0m
( 89.468s) Epoch 058/100: loss=5.524596[0m
( 89.423s) Epoch 059/100: loss=[32m5.522521[0m
( 89.368s) Epoch 060/100: loss=5.523319[0m  ( 41.203s)  train_acc=[32m0.017182[0m val_acc=[32m0.041101[0m test_acc=0.033385[0m
( 89.219s) Epoch 061/100: loss=[32m5.521183[0m
( 89.399s) Epoch 062/100: loss=5.522533[0m
( 89.379s) Epoch 063/100: loss=[32m5.521172[0m
( 89.361s) Epoch 064/100: loss=[32m5.520359[0m
( 89.451s) Epoch 065/100: loss=[32m5.518378[0m  ( 42.510s)  train_acc=0.016595[0m val_acc=[32m0.042214[0m test_acc=[32m0.035436[0m
( 89.636s) Epoch 066/100: loss=[32m5.518219[0m
( 89.501s) Epoch 067/100: loss=5.518589[0m
( 89.531s) Epoch 068/100: loss=5.518412[0m
( 89.551s) Epoch 069/100: loss=5.520202[0m
( 89.616s) Epoch 070/100: loss=[32m5.517585[0m  ( 41.157s)  train_acc=[32m0.017311[0m val_acc=0.039718[0m test_acc=0.032293[0m
( 89.484s) Epoch 071/100: loss=[32m5.515563[0m
( 89.924s) Epoch 072/100: loss=[32m5.514786[0m
( 89.837s) Epoch 073/100: loss=[32m5.513727[0m
( 89.586s) Epoch 074/100: loss=[32m5.512563[0m
( 89.692s) Epoch 075/100: loss=5.512835[0m  ( 42.659s)  train_acc=0.016417[0m val_acc=0.036936[0m test_acc=0.033917[0m
( 89.426s) Epoch 076/100: loss=5.513551[0m
( 89.668s) Epoch 077/100: loss=[32m5.512340[0m
( 89.710s) Epoch 078/100: loss=5.512552[0m
( 89.505s) Epoch 079/100: loss=[32m5.511396[0m
( 89.211s) Epoch 080/100: loss=[32m5.511029[0m  ( 40.464s)  train_acc=[32m0.017408[0m val_acc=0.041036[0m test_acc=0.035255[0m
( 89.385s) Epoch 081/100: loss=5.512451[0m
( 89.716s) Epoch 082/100: loss=[32m5.509966[0m
( 89.699s) Epoch 083/100: loss=[32m5.509578[0m
( 89.360s) Epoch 084/100: loss=5.510702[0m
( 89.081s) Epoch 085/100: loss=5.512027[0m  ( 38.712s)  train_acc=0.017184[0m val_acc=0.038315[0m test_acc=[32m0.035795[0m
( 89.757s) Epoch 086/100: loss=5.509856[0m
( 89.530s) Epoch 087/100: loss=[32m5.509221[0m
( 89.556s) Epoch 088/100: loss=[32m5.508622[0m
( 89.333s) Epoch 089/100: loss=5.509192[0m
( 89.230s) Epoch 090/100: loss=5.512618[0m  ( 40.395s)  train_acc=0.017149[0m val_acc=0.035258[0m test_acc=0.034374[0m
( 89.307s) Epoch 091/100: loss=5.509573[0m
( 89.464s) Epoch 092/100: loss=5.508829[0m
( 89.300s) Epoch 093/100: loss=5.510845[0m
( 89.275s) Epoch 094/100: loss=5.509579[0m
( 89.449s) Epoch 095/100: loss=[32m5.507966[0m  ( 39.816s)  train_acc=0.016994[0m val_acc=0.040305[0m test_acc=0.035036[0m
( 89.192s) Epoch 096/100: loss=5.509931[0m
( 89.601s) Epoch 097/100: loss=5.509783[0m
( 89.580s) Epoch 098/100: loss=5.508787[0m
( 89.612s) Epoch 099/100: loss=5.508617[0m
( 89.657s) Epoch 100/100: loss=5.510054[0m  ( 38.687s)  train_acc=[32m0.017654[0m val_acc=0.039552[0m test_acc=[32m0.036444[0m
Training for 100 epochs took 8949.134s total and 89.491s average
Calculating mean of transformed dataset using the best model state ... 20.607s
Saving best model and options to miniImgnet_round3/CropResize_ColorDistort_runs/run3.pth
