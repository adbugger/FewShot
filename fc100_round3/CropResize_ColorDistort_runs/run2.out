Namespace(T_max=100, backbone='resnet50', base_learning_rate=0.1, base_optimizer='SGD', batch_size=256, dampening=0.0, dataset='fc100', dataset_root=None, distributed=False, episode_strat='SimpleShotEpisodes', eval_freq=5, first_augment='CropResize', head='SimpleMLP', jitter_strength=1.0, k_shot=5, load_from=None, local_rank=0, log_file=<_io.TextIOWrapper name='fc100_round3/CropResize_ColorDistort_runs/run2.out' mode='a' encoding='UTF-8'>, loss_function='NTXent', model='SimCLRModel', momentum=0.9, n_way=5, nesterov=True, ntxent_temp=1.0, num_epochs=100, num_query=15, num_test_tasks=10000, num_workers=2, pin_memory=True, pretrained=False, progress=False, projection_dim=128, save_model=True, save_path='fc100_round3/CropResize_ColorDistort_runs/run2.pth', scheduler='CosineAnnealingLR', second_augment='ColorDistort', secondary_optimizer='LARS', shuffle=True, simple_opt=False, weight_decay=0.0001)
Starting Training on:
Train:  60 classes
Valid:  20 classes
Test:   20 classes
------------------
( 93.844s) Epoch 001/100: loss=[32m6.119981[0m
( 95.502s) Epoch 002/100: loss=[32m5.930446[0m
( 97.400s) Epoch 003/100: loss=[32m5.786408[0m
( 97.060s) Epoch 004/100: loss=[32m5.737118[0m
( 95.081s) Epoch 005/100: loss=[32m5.707609[0m  ( 49.948s)  train_acc=[32m0.030501[0m val_acc=[32m0.021785[0m test_acc=[32m0.042844[0m
( 97.248s) Epoch 006/100: loss=[32m5.682655[0m
( 96.057s) Epoch 007/100: loss=[32m5.655082[0m
( 96.405s) Epoch 008/100: loss=[32m5.633612[0m
( 93.849s) Epoch 009/100: loss=[32m5.624884[0m
( 93.876s) Epoch 010/100: loss=[32m5.612291[0m  ( 53.175s)  train_acc=[32m0.037664[0m val_acc=[32m0.023377[0m test_acc=[32m0.045738[0m
( 94.604s) Epoch 011/100: loss=[32m5.601788[0m
( 96.834s) Epoch 012/100: loss=[32m5.592828[0m
( 96.521s) Epoch 013/100: loss=[32m5.584142[0m
( 97.019s) Epoch 014/100: loss=[32m5.578696[0m
( 96.151s) Epoch 015/100: loss=[32m5.576294[0m  ( 66.688s)  train_acc=[32m0.041293[0m val_acc=[32m0.023927[0m test_acc=[32m0.048873[0m
( 95.784s) Epoch 016/100: loss=[32m5.566701[0m
( 95.550s) Epoch 017/100: loss=[32m5.563138[0m
( 95.348s) Epoch 018/100: loss=[32m5.558032[0m
( 95.448s) Epoch 019/100: loss=[32m5.555973[0m
( 95.254s) Epoch 020/100: loss=[32m5.552535[0m  ( 47.678s)  train_acc=[32m0.042727[0m val_acc=[32m0.025853[0m test_acc=0.047228[0m
Namespace(T_max=100, backbone='resnet50', base_learning_rate=0.1, base_optimizer='SGD', batch_size=256, dampening=0.0, dataset='fc100', dataset_root=None, distributed=False, episode_strat='SimpleShotEpisodes', eval_freq=5, first_augment='CropResize', head='SimpleMLP', jitter_strength=1.0, k_shot=5, load_from=None, local_rank=0, log_file=<_io.TextIOWrapper name='fc100_round3/CropResize_ColorDistort_runs/run2.out' mode='a' encoding='UTF-8'>, loss_function='NTXent', model='SimCLRModel', momentum=0.9, n_way=5, nesterov=True, ntxent_temp=1.0, num_epochs=100, num_query=15, num_test_tasks=10000, num_workers=2, pin_memory=True, pretrained=False, progress=False, projection_dim=128, save_model=True, save_path='fc100_round3/CropResize_ColorDistort_runs/run2.pth', scheduler='CosineAnnealingLR', second_augment='ColorDistort', secondary_optimizer='LARS', shuffle=True, simple_opt=False, weight_decay=0.0001)
Starting Training on:
Train:  60 classes
Valid:  20 classes
Test:   20 classes
------------------
(112.516s) Epoch 001/100: loss=[32m6.120945[0m
( 94.645s) Epoch 002/100: loss=[32m5.949063[0m
( 92.095s) Epoch 003/100: loss=[32m5.814211[0m
( 92.407s) Epoch 004/100: loss=[32m5.755539[0m
( 92.135s) Epoch 005/100: loss=[32m5.718309[0m  ( 61.860s)  train_acc=[32m0.031346[0m val_acc=[32m0.019264[0m test_acc=[32m0.042082[0m
( 92.800s) Epoch 006/100: loss=[32m5.686658[0m
( 92.575s) Epoch 007/100: loss=[32m5.660160[0m
( 92.150s) Epoch 008/100: loss=[32m5.643336[0m
( 91.381s) Epoch 009/100: loss=[32m5.628208[0m
( 91.576s) Epoch 010/100: loss=[32m5.612861[0m  ( 47.647s)  train_acc=[32m0.036194[0m val_acc=[32m0.021646[0m test_acc=0.037086[0m
( 93.528s) Epoch 011/100: loss=[32m5.608594[0m
( 95.766s) Epoch 012/100: loss=[32m5.598934[0m
( 93.707s) Epoch 013/100: loss=[32m5.591663[0m
( 93.935s) Epoch 014/100: loss=[32m5.585360[0m
( 91.996s) Epoch 015/100: loss=[32m5.575445[0m  ( 45.722s)  train_acc=[32m0.040674[0m val_acc=[32m0.025874[0m test_acc=[32m0.046586[0m
( 91.516s) Epoch 016/100: loss=[32m5.569489[0m
( 91.983s) Epoch 017/100: loss=[32m5.564114[0m
( 91.343s) Epoch 018/100: loss=[32m5.562026[0m
( 91.865s) Epoch 019/100: loss=[32m5.557030[0m
( 93.685s) Epoch 020/100: loss=[32m5.551442[0m  ( 49.435s)  train_acc=[32m0.041383[0m val_acc=0.024571[0m test_acc=[32m0.047066[0m
( 91.245s) Epoch 021/100: loss=[32m5.549499[0m
( 91.570s) Epoch 022/100: loss=[32m5.545991[0m
( 91.549s) Epoch 023/100: loss=[32m5.543044[0m
(107.823s) Epoch 024/100: loss=[32m5.538524[0m
( 92.950s) Epoch 025/100: loss=[32m5.535107[0m  ( 45.496s)  train_acc=[32m0.044559[0m val_acc=0.023735[0m test_acc=0.040225[0m
( 91.842s) Epoch 026/100: loss=[32m5.530308[0m
( 92.138s) Epoch 027/100: loss=[32m5.528139[0m
( 94.642s) Epoch 028/100: loss=[32m5.523292[0m
( 95.042s) Epoch 029/100: loss=[32m5.520406[0m
( 92.775s) Epoch 030/100: loss=[32m5.517964[0m  ( 53.629s)  train_acc=0.044457[0m val_acc=0.025705[0m test_acc=0.039843[0m
( 96.274s) Epoch 031/100: loss=[32m5.516103[0m
( 94.818s) Epoch 032/100: loss=[32m5.514280[0m
(101.799s) Epoch 033/100: loss=[32m5.511107[0m
( 94.682s) Epoch 034/100: loss=[32m5.510936[0m
( 92.336s) Epoch 035/100: loss=[32m5.505540[0m  ( 46.113s)  train_acc=[32m0.049355[0m val_acc=0.024426[0m test_acc=0.047036[0m
( 91.303s) Epoch 036/100: loss=[32m5.504841[0m
( 92.654s) Epoch 037/100: loss=[32m5.504476[0m
( 91.877s) Epoch 038/100: loss=[32m5.502646[0m
( 91.743s) Epoch 039/100: loss=[32m5.499907[0m
( 92.183s) Epoch 040/100: loss=[32m5.498852[0m  ( 46.527s)  train_acc=[32m0.051369[0m val_acc=[32m0.026104[0m test_acc=0.046600[0m
( 91.974s) Epoch 041/100: loss=[32m5.495633[0m
( 92.334s) Epoch 042/100: loss=5.496492[0m
( 91.287s) Epoch 043/100: loss=[32m5.494502[0m
( 92.148s) Epoch 044/100: loss=[32m5.491911[0m
( 91.941s) Epoch 045/100: loss=[32m5.490058[0m  ( 50.313s)  train_acc=0.050416[0m val_acc=[32m0.027977[0m test_acc=0.044310[0m
( 93.896s) Epoch 046/100: loss=[32m5.488997[0m
( 96.354s) Epoch 047/100: loss=5.489168[0m
( 92.327s) Epoch 048/100: loss=[32m5.487970[0m
( 91.577s) Epoch 049/100: loss=[32m5.486129[0m
( 91.663s) Epoch 050/100: loss=[32m5.485146[0m  ( 47.241s)  train_acc=[32m0.052116[0m val_acc=[32m0.028359[0m test_acc=0.042435[0m
( 90.760s) Epoch 051/100: loss=[32m5.483530[0m
( 94.819s) Epoch 052/100: loss=[32m5.481483[0m
( 95.054s) Epoch 053/100: loss=5.481747[0m
( 91.946s) Epoch 054/100: loss=[32m5.480196[0m
( 91.819s) Epoch 055/100: loss=[32m5.478439[0m  ( 46.192s)  train_acc=[32m0.055514[0m val_acc=0.026577[0m test_acc=0.039682[0m
( 94.706s) Epoch 056/100: loss=[32m5.477449[0m
( 92.572s) Epoch 057/100: loss=[32m5.475802[0m
( 91.761s) Epoch 058/100: loss=5.476662[0m
( 92.682s) Epoch 059/100: loss=[32m5.474688[0m
( 91.402s) Epoch 060/100: loss=[32m5.473884[0m  ( 58.337s)  train_acc=0.054336[0m val_acc=0.027526[0m test_acc=0.043526[0m
( 90.021s) Epoch 061/100: loss=[32m5.473665[0m
( 91.545s) Epoch 062/100: loss=[32m5.471787[0m
( 91.653s) Epoch 063/100: loss=[32m5.471386[0m
( 94.709s) Epoch 064/100: loss=[32m5.469497[0m
( 93.760s) Epoch 065/100: loss=5.470402[0m  ( 47.114s)  train_acc=[32m0.058338[0m val_acc=[32m0.030812[0m test_acc=0.041752[0m
( 90.882s) Epoch 066/100: loss=[32m5.469343[0m
( 92.516s) Epoch 067/100: loss=[32m5.468038[0m
( 92.209s) Epoch 068/100: loss=5.470367[0m
( 91.910s) Epoch 069/100: loss=5.468080[0m
( 91.721s) Epoch 070/100: loss=[32m5.466904[0m  ( 46.034s)  train_acc=0.054278[0m val_acc=0.029089[0m test_acc=0.044034[0m
( 92.881s) Epoch 071/100: loss=5.467048[0m
( 95.061s) Epoch 072/100: loss=[32m5.466186[0m
( 91.276s) Epoch 073/100: loss=[32m5.465529[0m
( 92.409s) Epoch 074/100: loss=5.465951[0m
( 91.795s) Epoch 075/100: loss=[32m5.463823[0m  ( 49.718s)  train_acc=0.054914[0m val_acc=0.027664[0m test_acc=0.041303[0m
( 92.757s) Epoch 076/100: loss=5.464554[0m
( 91.823s) Epoch 077/100: loss=[32m5.462291[0m
( 91.506s) Epoch 078/100: loss=5.464442[0m
( 91.598s) Epoch 079/100: loss=5.464338[0m
( 91.889s) Epoch 080/100: loss=5.463713[0m  ( 50.937s)  train_acc=[32m0.059302[0m val_acc=0.030050[0m test_acc=0.040055[0m
( 90.230s) Epoch 081/100: loss=5.462382[0m
( 91.441s) Epoch 082/100: loss=5.462689[0m
( 94.236s) Epoch 083/100: loss=5.463063[0m
( 95.475s) Epoch 084/100: loss=[32m5.461225[0m
( 91.909s) Epoch 085/100: loss=5.462350[0m  ( 45.873s)  train_acc=0.059068[0m val_acc=[32m0.031222[0m test_acc=0.045573[0m
( 91.837s) Epoch 086/100: loss=5.462326[0m
(100.247s) Epoch 087/100: loss=5.461598[0m
( 91.949s) Epoch 088/100: loss=[32m5.459735[0m
( 92.019s) Epoch 089/100: loss=5.461068[0m
( 91.312s) Epoch 090/100: loss=5.460178[0m  ( 49.848s)  train_acc=0.056611[0m val_acc=0.030877[0m test_acc=0.041678[0m
( 90.036s) Epoch 091/100: loss=5.461817[0m
( 91.998s) Epoch 092/100: loss=5.460845[0m
( 91.535s) Epoch 093/100: loss=5.460901[0m
( 91.698s) Epoch 094/100: loss=5.460279[0m
( 92.063s) Epoch 095/100: loss=5.460141[0m  ( 48.698s)  train_acc=[32m0.059714[0m val_acc=[32m0.031345[0m test_acc=0.043532[0m
( 94.643s) Epoch 096/100: loss=[32m5.459655[0m
( 92.340s) Epoch 097/100: loss=[32m5.459146[0m
( 92.776s) Epoch 098/100: loss=5.460836[0m
( 93.788s) Epoch 099/100: loss=5.460266[0m
( 98.726s) Epoch 100/100: loss=5.460659[0m  ( 43.727s)  train_acc=0.058079[0m val_acc=0.031230[0m test_acc=0.043841[0m
Training for 100 epochs took 9312.053s total and 93.121s average
Calculating mean of transformed dataset using the best model state ... 22.052s
Saving best model and options to fc100_round3/CropResize_ColorDistort_runs/run2.pth
