Namespace(T_max=100, backbone='resnet50', base_learning_rate=0.1, base_optimizer='SGD', batch_size=256, dampening=0.0, dataset='miniImagenet', dataset_root=None, distributed=False, episode_strat='SimpleShotEpisodes', eval_freq=5, first_augment='CropResize', head='SimpleMLP', jitter_strength=1.0, k_shot=5, load_from=None, local_rank=0, log_file=<_io.TextIOWrapper name='miniImgnet_round3/CropResize_ColorDistort_runs/run4.out' mode='a' encoding='UTF-8'>, loss_function='NTXent', model='SimCLRModel', momentum=0.9, n_way=5, nesterov=True, ntxent_temp=1.0, num_epochs=100, num_query=15, num_test_tasks=10000, num_workers=4, pin_memory=True, pretrained=False, progress=False, projection_dim=128, save_model=True, save_path='miniImgnet_round3/CropResize_ColorDistort_runs/run4.pth', scheduler='CosineAnnealingLR', second_augment='ColorDistort', secondary_optimizer='LARS', shuffle=True, simple_opt=False, weight_decay=0.0001)
Starting Training on:
Train:  64 classes
Valid:  16 classes
Test:   20 classes
------------------
( 88.575s) Epoch 001/100: loss=[32m6.177181[0m
( 88.889s) Epoch 002/100: loss=[32m6.037415[0m
( 91.265s) Epoch 003/100: loss=[32m5.956620[0m
( 88.826s) Epoch 004/100: loss=[32m5.884573[0m
( 88.778s) Epoch 005/100: loss=[32m5.820779[0m  ( 41.271s)  train_acc=[32m0.011074[0m val_acc=[32m0.026481[0m test_acc=[32m0.017815[0m
( 88.777s) Epoch 006/100: loss=[32m5.784537[0m
( 89.007s) Epoch 007/100: loss=[32m5.763673[0m
( 95.625s) Epoch 008/100: loss=[32m5.748403[0m
( 89.174s) Epoch 009/100: loss=[32m5.728881[0m
( 89.114s) Epoch 010/100: loss=[32m5.716553[0m  ( 42.912s)  train_acc=[32m0.012029[0m val_acc=0.026443[0m test_acc=[32m0.019510[0m
( 88.902s) Epoch 011/100: loss=[32m5.702641[0m
( 88.939s) Epoch 012/100: loss=[32m5.693113[0m
( 90.760s) Epoch 013/100: loss=[32m5.685694[0m
( 88.853s) Epoch 014/100: loss=[32m5.674327[0m
( 88.854s) Epoch 015/100: loss=[32m5.669381[0m  ( 41.832s)  train_acc=[32m0.012270[0m val_acc=[32m0.027382[0m test_acc=[32m0.020123[0m
( 88.878s) Epoch 016/100: loss=[32m5.655332[0m
( 89.324s) Epoch 017/100: loss=[32m5.645225[0m
( 89.175s) Epoch 018/100: loss=[32m5.641629[0m
( 88.854s) Epoch 019/100: loss=[32m5.632437[0m
( 88.990s) Epoch 020/100: loss=[32m5.627654[0m  ( 40.757s)  train_acc=[32m0.014112[0m val_acc=[32m0.032923[0m test_acc=[32m0.023938[0m
( 89.160s) Epoch 021/100: loss=[32m5.622285[0m
( 89.345s) Epoch 022/100: loss=[32m5.619584[0m
( 89.162s) Epoch 023/100: loss=[32m5.611580[0m
( 89.258s) Epoch 024/100: loss=[32m5.607525[0m
( 89.124s) Epoch 025/100: loss=[32m5.602487[0m  ( 39.918s)  train_acc=[32m0.014904[0m val_acc=0.032106[0m test_acc=[32m0.026963[0m
( 89.055s) Epoch 026/100: loss=[32m5.599768[0m
( 88.958s) Epoch 027/100: loss=[32m5.594432[0m
( 88.777s) Epoch 028/100: loss=[32m5.590910[0m
( 94.219s) Epoch 029/100: loss=[32m5.586023[0m
( 89.092s) Epoch 030/100: loss=[32m5.582237[0m  ( 39.909s)  train_acc=[32m0.015388[0m val_acc=[32m0.036537[0m test_acc=[32m0.027269[0m
( 89.141s) Epoch 031/100: loss=[32m5.578485[0m
( 88.903s) Epoch 032/100: loss=[32m5.573287[0m
( 88.837s) Epoch 033/100: loss=[32m5.569632[0m
( 88.870s) Epoch 034/100: loss=[32m5.566634[0m
( 94.078s) Epoch 035/100: loss=[32m5.565815[0m  ( 43.135s)  train_acc=[32m0.016179[0m val_acc=0.034168[0m test_acc=[32m0.030501[0m
( 89.090s) Epoch 036/100: loss=[32m5.561794[0m
( 89.401s) Epoch 037/100: loss=5.563143[0m
( 89.361s) Epoch 038/100: loss=[32m5.558168[0m
( 89.298s) Epoch 039/100: loss=[32m5.556163[0m
( 89.153s) Epoch 040/100: loss=[32m5.554640[0m  ( 42.879s)  train_acc=0.015570[0m val_acc=0.034169[0m test_acc=[32m0.031461[0m
( 89.229s) Epoch 041/100: loss=[32m5.550792[0m
( 89.806s) Epoch 042/100: loss=[32m5.547241[0m
( 89.403s) Epoch 043/100: loss=[32m5.547155[0m
( 89.200s) Epoch 044/100: loss=[32m5.545645[0m
( 89.014s) Epoch 045/100: loss=[32m5.541285[0m  ( 40.206s)  train_acc=[32m0.016280[0m val_acc=[32m0.040875[0m test_acc=[32m0.032294[0m
( 89.125s) Epoch 046/100: loss=[32m5.540980[0m
( 89.404s) Epoch 047/100: loss=5.541132[0m
( 89.229s) Epoch 048/100: loss=[32m5.536465[0m
( 89.153s) Epoch 049/100: loss=5.537821[0m
( 89.260s) Epoch 050/100: loss=[32m5.535423[0m  ( 43.301s)  train_acc=[32m0.016323[0m val_acc=0.038673[0m test_acc=[32m0.034468[0m
( 88.998s) Epoch 051/100: loss=[32m5.532703[0m
( 89.054s) Epoch 052/100: loss=[32m5.532621[0m
( 88.926s) Epoch 053/100: loss=[32m5.529863[0m
( 88.988s) Epoch 054/100: loss=5.531554[0m
( 88.705s) Epoch 055/100: loss=[32m5.529419[0m  ( 43.506s)  train_acc=0.016167[0m val_acc=0.039061[0m test_acc=0.034033[0m
( 88.869s) Epoch 056/100: loss=[32m5.527085[0m
( 89.375s) Epoch 057/100: loss=5.528801[0m
( 88.918s) Epoch 058/100: loss=[32m5.526865[0m
( 88.979s) Epoch 059/100: loss=[32m5.525291[0m
( 88.593s) Epoch 060/100: loss=[32m5.523547[0m  ( 43.673s)  train_acc=[32m0.016681[0m val_acc=0.036406[0m test_acc=0.032117[0m
( 89.036s) Epoch 061/100: loss=5.523656[0m
( 89.476s) Epoch 062/100: loss=[32m5.523326[0m
( 89.066s) Epoch 063/100: loss=[32m5.520953[0m
( 89.296s) Epoch 064/100: loss=5.521910[0m
( 89.094s) Epoch 065/100: loss=[32m5.519696[0m  ( 43.708s)  train_acc=[32m0.017196[0m val_acc=0.039320[0m test_acc=[32m0.036487[0m
( 89.160s) Epoch 066/100: loss=[32m5.519381[0m
( 89.464s) Epoch 067/100: loss=[32m5.518928[0m
( 89.150s) Epoch 068/100: loss=5.520187[0m
( 88.980s) Epoch 069/100: loss=5.520120[0m
( 88.981s) Epoch 070/100: loss=[32m5.516985[0m  ( 42.153s)  train_acc=0.017034[0m val_acc=0.040672[0m test_acc=0.031853[0m
( 89.024s) Epoch 071/100: loss=5.518080[0m
( 89.299s) Epoch 072/100: loss=5.517277[0m
( 88.837s) Epoch 073/100: loss=5.517294[0m
( 91.225s) Epoch 074/100: loss=[32m5.515997[0m
( 88.968s) Epoch 075/100: loss=5.517432[0m  ( 43.658s)  train_acc=0.016916[0m val_acc=0.039391[0m test_acc=0.031704[0m
( 89.391s) Epoch 076/100: loss=5.517001[0m
( 89.340s) Epoch 077/100: loss=[32m5.515475[0m
( 88.915s) Epoch 078/100: loss=[32m5.513216[0m
( 89.087s) Epoch 079/100: loss=5.514924[0m
( 88.939s) Epoch 080/100: loss=[32m5.512382[0m  ( 43.081s)  train_acc=0.017005[0m val_acc=0.040338[0m test_acc=0.034089[0m
( 89.025s) Epoch 081/100: loss=[32m5.511966[0m
( 89.450s) Epoch 082/100: loss=5.513411[0m
( 88.990s) Epoch 083/100: loss=5.512803[0m
( 88.920s) Epoch 084/100: loss=5.513592[0m
( 89.134s) Epoch 085/100: loss=[32m5.511266[0m  ( 40.206s)  train_acc=0.017187[0m val_acc=0.038589[0m test_acc=0.032562[0m
( 89.598s) Epoch 086/100: loss=5.513047[0m
( 89.298s) Epoch 087/100: loss=[32m5.510438[0m
( 89.027s) Epoch 088/100: loss=5.511451[0m
( 88.963s) Epoch 089/100: loss=5.511551[0m
( 89.022s) Epoch 090/100: loss=5.511175[0m  ( 42.199s)  train_acc=[32m0.017453[0m val_acc=0.038500[0m test_acc=0.033763[0m
( 89.112s) Epoch 091/100: loss=5.511640[0m
( 89.326s) Epoch 092/100: loss=5.511248[0m
( 89.172s) Epoch 093/100: loss=5.512780[0m
( 89.136s) Epoch 094/100: loss=[32m5.510050[0m
( 88.993s) Epoch 095/100: loss=5.510951[0m  ( 40.716s)  train_acc=0.017121[0m val_acc=0.038989[0m test_acc=0.035061[0m
( 88.953s) Epoch 096/100: loss=5.511151[0m
( 89.377s) Epoch 097/100: loss=5.512807[0m
( 89.125s) Epoch 098/100: loss=5.512179[0m
( 88.981s) Epoch 099/100: loss=5.512541[0m
( 89.135s) Epoch 100/100: loss=5.511023[0m  ( 40.564s)  train_acc=0.016972[0m val_acc=[32m0.043039[0m test_acc=[32m0.037121[0m
Training for 100 epochs took 8931.536s total and 89.315s average
Calculating mean of transformed dataset using the best model state ... 20.869s
Saving best model and options to miniImgnet_round3/CropResize_ColorDistort_runs/run4.pth
